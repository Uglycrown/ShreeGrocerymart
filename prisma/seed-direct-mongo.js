// Direct MongoDB seed script without Prisma transactions
// Run with: node prisma/seed-direct-mongo.js

const { MongoClient, ObjectId } = require('mongodb')

const uri = process.env.DATABASE_URL || process.env.MONGODB_URI || 'mongodb://localhost:27017/blinkit'

async function main() {
  console.log('üå± Starting Indian grocery store seed...\n')
  console.log('üì° Connecting to MongoDB...')
  
  const client = new MongoClient(uri)
  
  try {
    await client.connect()
    const db = client.db()
    
    console.log('‚úÖ Connected to database\n')

    // Clear existing data (without transactions)
    console.log('üßπ Cleaning existing data...')
    try {
      await db.collection('Product').drop().catch(() => {})
      await db.collection('Category').drop().catch(() => {})
      await db.collection('Banner').drop().catch(() => {})
    } catch (e) {
      // Collections might not exist
    }
    console.log('‚úÖ Cleaned\n')

    // Create Categories
    console.log('üìÅ Creating categories...')
    
    const categories = {
      dairy: new ObjectId(),
      dals: new ObjectId(),
      atta: new ObjectId(),
      oils: new ObjectId(),
      spices: new ObjectId(),
      fruits: new ObjectId(),
      snacks: new ObjectId(),
      beverages: new ObjectId(),
    }

    await db.collection('Category').insertMany([
      {
        _id: categories.dairy,
        name: 'Dairy & Eggs',
        slug: 'dairy-eggs',
        image: 'https://images.unsplash.com/photo-1550583724-b2692b85b150?w=400',
        description: 'Fresh milk, paneer, butter, ghee, eggs',
        order: 1,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: categories.dals,
        name: 'Dals & Pulses',
        slug: 'dals-pulses',
        image: 'https://images.unsplash.com/photo-1602524206684-bc8e4d4e8f37?w=400',
        description: 'Toor dal, moong dal, chana, masoor, rajma',
        order: 2,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: categories.atta,
        name: 'Atta, Rice & Dal',
        slug: 'atta-rice-dal',
        image: 'https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400',
        description: 'Wheat flour, rice varieties, pulses',
        order: 3,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: categories.oils,
        name: 'Edible Oils & Ghee',
        slug: 'oils-ghee',
        image: 'https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=400',
        description: 'Cooking oils, ghee, refined oil',
        order: 4,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: categories.spices,
        name: 'Masala & Spices',
        slug: 'masala-spices',
        image: 'https://images.unsplash.com/photo-1596040033229-a0b5b8e52f5a?w=400',
        description: 'Turmeric, chilli, garam masala, whole spices',
        order: 5,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: categories.fruits,
        name: 'Fruits & Vegetables',
        slug: 'fruits-vegetables',
        image: 'https://images.unsplash.com/photo-1610348725531-843dff563e2c?w=400',
        description: 'Farm-fresh fruits and vegetables',
        order: 6,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: categories.snacks,
        name: 'Snacks & Namkeen',
        slug: 'snacks-namkeen',
        image: 'https://images.unsplash.com/photo-1599490659213-e2b9527bd087?w=400',
        description: 'Chips, namkeen, biscuits',
        order: 7,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: categories.beverages,
        name: 'Beverages',
        slug: 'beverages',
        image: 'https://images.unsplash.com/photo-1523677011781-c91d1bbe3ea1?w=400',
        description: 'Tea, coffee, cold drinks, juices',
        order: 8,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
    ])

    console.log('‚úÖ 8 Categories created\n')

    // Create Products
    console.log('üì¶ Creating products...')
    
    const products = [
      // Dairy Products
      {
        _id: new ObjectId(),
        name: 'Amul Gold Full Cream Milk',
        slug: 'amul-gold-milk-500ml',
        description: 'Fresh and pure full cream milk with 6% fat',
        categoryId: categories.dairy,
        images: ['https://images.unsplash.com/photo-1550583724-b2692b85b150?w=400&q=80'],
        price: 35,
        originalPrice: 38,
        discount: 8,
        unit: '500 ml',
        stock: 150,
        isActive: true,
        isFeatured: true,
        tags: ['milk', 'dairy', 'amul', 'fresh'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Amul Salted Butter',
        slug: 'amul-butter-100g',
        description: 'Premium quality pasteurized salted butter',
        categoryId: categories.dairy,
        images: ['https://images.unsplash.com/photo-1589985270826-4b7bb135bc9d?w=400'],
        price: 58,
        originalPrice: 62,
        discount: 6,
        unit: '100 g',
        stock: 100,
        isActive: true,
        isFeatured: true,
        tags: ['butter', 'dairy', 'amul'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Amul Fresh Paneer',
        slug: 'amul-paneer-200g',
        description: 'Fresh soft paneer made from pure milk',
        categoryId: categories.dairy,
        images: ['https://images.unsplash.com/photo-1628408135644-8cc1794c5299?w=400&q=80'],
        price: 90,
        unit: '200 g',
        stock: 80,
        isActive: true,
        tags: ['paneer', 'dairy', 'protein'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Amul Cow Ghee',
        slug: 'amul-cow-ghee-500ml',
        description: 'Pure cow ghee made from fresh cream',
        categoryId: categories.dairy,
        images: ['https://images.unsplash.com/photo-1628408135644-8cc1794c5299?w=400'],
        price: 340,
        originalPrice: 360,
        discount: 6,
        unit: '500 ml',
        stock: 50,
        isActive: true,
        isFeatured: true,
        tags: ['ghee', 'dairy', 'amul', 'pure'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Farm Fresh Brown Eggs',
        slug: 'brown-eggs-6pc',
        description: 'Protein-rich cage-free brown eggs',
        categoryId: categories.dairy,
        images: ['https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?w=400'],
        price: 42,
        unit: '6 pieces',
        stock: 120,
        isActive: true,
        tags: ['eggs', 'protein', 'fresh'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      // Dals & Pulses
      {
        _id: new ObjectId(),
        name: 'Toor Dal (Arhar Dal)',
        slug: 'toor-dal-1kg',
        description: 'Premium quality yellow pigeon peas',
        categoryId: categories.dals,
        images: ['https://images.unsplash.com/photo-1587486937626-18c3c99279f8?w=400&q=80'],
        price: 135,
        originalPrice: 150,
        discount: 10,
        unit: '1 kg',
        stock: 200,
        isActive: true,
        isFeatured: true,
        tags: ['dal', 'toor', 'pulses', 'protein'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Moong Dal (Yellow)',
        slug: 'moong-dal-yellow-1kg',
        description: 'Split yellow moong lentils',
        categoryId: categories.dals,
        images: ['https://images.unsplash.com/photo-1610089538924-f2f8d0b6c8d4?w=400&q=80'],
        price: 120,
        unit: '1 kg',
        stock: 180,
        isActive: true,
        isFeatured: true,
        tags: ['dal', 'moong', 'pulses'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Masoor Dal (Red Lentils)',
        slug: 'masoor-dal-1kg',
        description: 'Split red lentils for quick cooking',
        categoryId: categories.dals,
        images: ['https://images.unsplash.com/photo-1599909533895-8e36d3bc4ad0?w=400&q=80'],
        price: 110,
        originalPrice: 125,
        discount: 12,
        unit: '1 kg',
        stock: 150,
        isActive: true,
        tags: ['dal', 'masoor', 'red-lentils'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Chana Dal',
        slug: 'chana-dal-1kg',
        description: 'Split bengal gram lentils',
        categoryId: categories.dals,
        images: ['https://images.unsplash.com/photo-1607672632458-9eb56696346b?w=400&q=80'],
        price: 90,
        unit: '1 kg',
        stock: 160,
        isActive: true,
        tags: ['dal', 'chana', 'pulses'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Urad Dal (Black Gram)',
        slug: 'urad-dal-1kg',
        description: 'Split black gram for idli, dosa',
        categoryId: categories.dals,
        images: ['https://images.unsplash.com/photo-1615485290161-c8f5c78a3e5e?w=400&q=80'],
        price: 115,
        unit: '1 kg',
        stock: 140,
        isActive: true,
        tags: ['dal', 'urad', 'black-gram'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Rajma (Red Kidney Beans)',
        slug: 'rajma-red-1kg',
        description: 'Premium Kashmiri rajma',
        categoryId: categories.dals,
        images: ['https://images.unsplash.com/photo-1596040033229-a0b5b8e52f5a?w=400&q=80'],
        price: 160,
        originalPrice: 180,
        discount: 11,
        unit: '1 kg',
        stock: 100,
        isActive: true,
        isFeatured: true,
        tags: ['rajma', 'kidney-beans', 'protein'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      // Atta & Rice
      {
        _id: new ObjectId(),
        name: 'Aashirvaad Whole Wheat Atta',
        slug: 'aashirvaad-atta-5kg',
        description: 'Premium quality chakki atta',
        categoryId: categories.atta,
        images: ['https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=400&q=80'],
        price: 255,
        originalPrice: 280,
        discount: 9,
        unit: '5 kg',
        stock: 100,
        isActive: true,
        isFeatured: true,
        tags: ['atta', 'wheat', 'flour', 'aashirvaad'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'India Gate Basmati Rice',
        slug: 'india-gate-basmati-5kg',
        description: 'Premium aged basmati rice',
        categoryId: categories.atta,
        images: ['https://images.unsplash.com/photo-1536304993881-ff6e9eefa2a6?w=400&q=80'],
        price: 425,
        originalPrice: 475,
        discount: 11,
        unit: '5 kg',
        stock: 80,
        isActive: true,
        isFeatured: true,
        tags: ['rice', 'basmati', 'premium'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Sona Masoori Rice',
        slug: 'sona-masoori-rice-5kg',
        description: 'Premium quality south Indian rice',
        categoryId: categories.atta,
        images: ['https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400&q=80'],
        price: 280,
        originalPrice: 310,
        discount: 10,
        unit: '5 kg',
        stock: 100,
        isActive: true,
        tags: ['rice', 'sona-masoori'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Besan (Gram Flour)',
        slug: 'besan-1kg',
        description: 'Pure gram flour for pakoras',
        categoryId: categories.atta,
        images: ['https://images.unsplash.com/photo-1584270354949-c26b0d5b4a0c?w=400&q=80'],
        price: 75,
        unit: '1 kg',
        stock: 120,
        isActive: true,
        tags: ['besan', 'flour', 'gram'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      // Oils & Ghee
      {
        _id: new ObjectId(),
        name: 'Fortune Sunflower Oil',
        slug: 'fortune-sunflower-oil-1l',
        description: 'Refined sunflower cooking oil',
        categoryId: categories.oils,
        images: ['https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=400'],
        price: 155,
        originalPrice: 170,
        discount: 9,
        unit: '1 L',
        stock: 100,
        isActive: true,
        isFeatured: true,
        tags: ['oil', 'sunflower', 'cooking'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Fortune Mustard Oil',
        slug: 'fortune-mustard-oil-1l',
        description: 'Pure mustard cooking oil',
        categoryId: categories.oils,
        images: ['https://images.unsplash.com/photo-1628408135644-8cc1794c5299?w=400&q=80'],
        price: 175,
        unit: '1 L',
        stock: 90,
        isActive: true,
        tags: ['oil', 'mustard', 'kachi-ghani'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      // Spices
      {
        _id: new ObjectId(),
        name: 'MDH Garam Masala',
        slug: 'mdh-garam-masala-100g',
        description: 'Aromatic blend of Indian spices',
        categoryId: categories.spices,
        images: ['https://images.unsplash.com/photo-1596040033229-a0b5b8e52f5a?w=400'],
        price: 90,
        unit: '100 g',
        stock: 150,
        isActive: true,
        isFeatured: true,
        tags: ['masala', 'spices', 'mdh'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Everest Turmeric Powder',
        slug: 'everest-turmeric-200g',
        description: 'Pure haldi powder',
        categoryId: categories.spices,
        images: ['https://images.unsplash.com/photo-1596040033229-a0b5b8e52f5a?w=400&q=80'],
        price: 85,
        unit: '200 g',
        stock: 180,
        isActive: true,
        tags: ['haldi', 'turmeric', 'everest'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Everest Red Chilli Powder',
        slug: 'everest-chilli-powder-200g',
        description: 'Spicy red chilli powder',
        categoryId: categories.spices,
        images: ['https://images.unsplash.com/photo-1583663824682-4f46c0c2f4e5?w=400&q=80'],
        price: 95,
        unit: '200 g',
        stock: 170,
        isActive: true,
        tags: ['chilli', 'lal-mirch', 'everest'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      // Fruits & Vegetables
      {
        _id: new ObjectId(),
        name: 'Fresh Red Apples (Shimla)',
        slug: 'red-apples-shimla',
        description: 'Crispy and sweet red apples',
        categoryId: categories.fruits,
        images: ['https://images.unsplash.com/photo-1568702846914-96b305d2aaeb?w=400'],
        price: 160,
        originalPrice: 180,
        discount: 11,
        unit: '1 kg',
        stock: 100,
        isActive: true,
        isFeatured: true,
        tags: ['fruits', 'apples', 'fresh'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Fresh Bananas (Robusta)',
        slug: 'bananas-robusta',
        description: 'Naturally ripened yellow bananas',
        categoryId: categories.fruits,
        images: ['https://images.unsplash.com/photo-1603833665858-e61d17a86224?w=400'],
        price: 50,
        unit: '1 dozen',
        stock: 150,
        isActive: true,
        tags: ['fruits', 'bananas', 'fresh'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Fresh Tomatoes',
        slug: 'tomatoes-desi',
        description: 'Locally sourced ripe tomatoes',
        categoryId: categories.fruits,
        images: ['https://images.unsplash.com/photo-1546094096-0df4bcaaa337?w=400'],
        price: 40,
        unit: '1 kg',
        stock: 200,
        isActive: true,
        tags: ['vegetables', 'tomatoes', 'fresh'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Fresh Onions',
        slug: 'onions-nashik',
        description: 'Fresh Nashik onions',
        categoryId: categories.fruits,
        images: ['https://images.unsplash.com/photo-1508747703725-719777637510?w=400'],
        price: 45,
        unit: '1 kg',
        stock: 180,
        isActive: true,
        isFeatured: true,
        tags: ['vegetables', 'onions', 'fresh'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Fresh Potatoes',
        slug: 'potatoes-local',
        description: 'Farm fresh potatoes',
        categoryId: categories.fruits,
        images: ['https://images.unsplash.com/photo-1518977676601-b53f82aba655?w=400'],
        price: 35,
        unit: '1 kg',
        stock: 200,
        isActive: true,
        tags: ['vegetables', 'potatoes', 'aloo'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      // Snacks
      {
        _id: new ObjectId(),
        name: 'Haldiram\'s Aloo Bhujia',
        slug: 'haldirams-aloo-bhujia-400g',
        description: 'Crispy and spicy potato namkeen',
        categoryId: categories.snacks,
        images: ['https://images.unsplash.com/photo-1621939514649-280e2ee25f60?w=400&q=80'],
        price: 95,
        originalPrice: 105,
        discount: 10,
        unit: '400 g',
        stock: 100,
        isActive: true,
        isFeatured: true,
        tags: ['snacks', 'namkeen', 'haldirams'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Lay\'s Classic Salted Chips',
        slug: 'lays-classic-chips-90g',
        description: 'Crispy potato chips',
        categoryId: categories.snacks,
        images: ['https://images.unsplash.com/photo-1566478989037-eec170784d0b?w=400'],
        price: 30,
        unit: '90 g',
        stock: 150,
        isActive: true,
        tags: ['snacks', 'chips', 'lays'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Parle-G Biscuits',
        slug: 'parle-g-biscuits-376g',
        description: 'India\'s favorite glucose biscuits',
        categoryId: categories.snacks,
        images: ['https://images.unsplash.com/photo-1606312619070-d48b4f0b4e8a?w=400&q=80'],
        price: 40,
        unit: '376 g',
        stock: 180,
        isActive: true,
        isFeatured: true,
        tags: ['biscuits', 'parle-g', 'snacks'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      // Beverages
      {
        _id: new ObjectId(),
        name: 'Tata Tea Gold',
        slug: 'tata-tea-gold-500g',
        description: 'Premium blend black tea',
        categoryId: categories.beverages,
        images: ['https://images.unsplash.com/photo-1564890369478-c89ca6d9cde9?w=400&q=80'],
        price: 245,
        originalPrice: 270,
        discount: 9,
        unit: '500 g',
        stock: 100,
        isActive: true,
        isFeatured: true,
        tags: ['tea', 'chai', 'tata'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Nescafe Classic Coffee',
        slug: 'nescafe-classic-50g',
        description: 'Instant coffee powder',
        categoryId: categories.beverages,
        images: ['https://images.unsplash.com/photo-1559056199-641a0ac8b55e?w=400'],
        price: 210,
        unit: '50 g',
        stock: 80,
        isActive: true,
        tags: ['coffee', 'instant', 'nescafe'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        name: 'Coca-Cola Soft Drink',
        slug: 'coca-cola-2l',
        description: 'Classic cola beverage',
        categoryId: categories.beverages,
        images: ['https://images.unsplash.com/photo-1554866585-cd94860890b7?w=400'],
        price: 90,
        originalPrice: 100,
        discount: 10,
        unit: '2 L',
        stock: 120,
        isActive: true,
        tags: ['cold-drink', 'cola', 'coke'],
        deliveryTime: 24,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
    ]

    await db.collection('Product').insertMany(products)
    console.log(`‚úÖ ${products.length} Products created\n`)

    // Create Banners
    console.log('üé® Creating banners...')
    await db.collection('Banner').insertMany([
      {
        _id: new ObjectId(),
        title: 'Fresh Groceries in 24 Minutes',
        subtitle: 'Dals, Atta, Rice & More at your doorstep',
        image: 'https://images.unsplash.com/photo-1542838132-92c53300491e?w=1200',
        link: '/',
        ctaText: 'Shop Now',
        type: 'HERO',
        order: 1,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        _id: new ObjectId(),
        title: 'Premium Dals & Pulses',
        subtitle: 'Toor, Moong, Masoor & More',
        image: 'https://images.unsplash.com/photo-1602524206684-bc8e4d4e8f37?w=600',
        link: '/category/dals-pulses',
        ctaText: 'Browse Dals',
        type: 'CATEGORY',
        order: 1,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
    ])
    console.log('‚úÖ Banners created\n')

    console.log('üéâ Indian Grocery Store seeding completed!\n')
    console.log('üìä Summary:')
    console.log(`  - 8 Categories`)
    console.log(`  - ${products.length} Products`)
    console.log('  - 2 Banners')
    console.log('\n‚úÖ Your grocery store is ready!')
    console.log('Visit http://localhost:3000 to see your products\n')

  } catch (error) {
    console.error('‚ùå Error seeding database:', error)
    process.exit(1)
  } finally {
    await client.close()
  }
}

main()
